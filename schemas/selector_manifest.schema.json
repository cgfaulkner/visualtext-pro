{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Selector Manifest Record (array)",
    "type": "array",
    "items": {
      "type": "object",
      "required": [
        "selector_version",
        "element_id",
        "selector_decision",
        "content_scope",
        "reason_code",
        "human_reason",
        "escalation_strategy",
        "metadata"
      ],
      "properties": {
        "selector_version": {
          "type": "string",
          "minLength": 1
        },
        "element_id": {
          "type": "string",
          "minLength": 1
        },
        "parent_group_id": {
          "oneOf": [
            { "type": "string", "minLength": 1 },
            { "type": "null" }
          ]
        },
        "selector_decision": {
          "type": "string",
          "enum": [
            "include_atomic",
            "include_group",
            "exclude_decorative",
            "exclude_redundant",
            "escalate_manual_review",
            "preserve_conflict"
          ]
        },
        "content_scope": {
          "type": "string",
          "enum": ["image", "group", "slide_context"]
        },
        "reason_code": {
          "type": "string",
          "minLength": 1
        },
        "human_reason": {
          "type": "string",
          "minLength": 1
        },
        "escalation_strategy": {
          "type": "string",
          "enum": [
            "none",
            "include_with_ambiguous_reason",
            "defer_to_manual_review",
            "render_and_assist",
            "convert_and_reinspect"
          ]
        },
        "metadata": {
          "type": "object",
          "properties": {
            "original_shape_type": { "type": "string" },
            "has_overlay": { "type": "boolean" },
            "overlay_ids": {
              "type": "array",
              "items": { "type": "string" }
            },
            "detected_subtype": { "type": "string" }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": false,
      "if": {
        "properties": {
          "selector_decision": { "const": "exclude_redundant" }
        }
      },
      "then": {
        "required": ["parent_group_id"]
      }
    }
  }  